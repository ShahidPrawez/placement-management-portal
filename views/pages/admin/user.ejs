<%- include('../../partials/header') %>
<div class="container mt-4">
  <h2>User Details</h2>
  <div class="card">
    <div class="card-body">
      <h4><%= userDoc.name %> <small class="text-muted">(<%= userDoc.role %>)</small></h4>
      <p><strong>Email:</strong> <%= userDoc.email %></p>
      <% if (userDoc.role === 'student') { %>
        <p><strong>Branch:</strong> <%= userDoc.branch %></p>
        <p><strong>Year:</strong> <%= userDoc.year %></p>
        <p><strong>CGPA:</strong> <%= userDoc.cgpa || 'N/A' %></p>
        <p><strong>Skills:</strong> <%= (userDoc.skills || []).join(', ') %></p>
        <p><strong>Resume:</strong> <% if (userDoc.resume) { %><a href="<%= userDoc.resume %>" target="_blank">Download</a><% } else { %>N/A<% } %></p>
      <% } %>

      <% if (userDoc.role === 'company') { %>
        <p><strong>Company Name:</strong> <%= userDoc.companyName || userDoc.name %></p>
        <p><strong>Industry:</strong> <%= userDoc.industry || 'N/A' %></p>
        <p><strong>Website:</strong> <% if (userDoc.website) { %><a href="<%= userDoc.website %>" target="_blank"><%= userDoc.website %></a><% } else { %>N/A<% } %></p>
        <p><strong>Description:</strong> <%= userDoc.description || 'N/A' %></p>
      <% } %>

      <p><strong>Phone:</strong> <%= userDoc.phone || 'N/A' %></p>
      <p><strong>Status:</strong> <%= userDoc.status || 'active' %></p>

      <div class="mt-3">
        <a href="/admin/users/impersonate/<%= userDoc._id %>" class="btn btn-sm btn-secondary" onclick="return confirm('Impersonate this user? You will become this user until you stop impersonation.')">Login as user</a>
        <form action="/admin/users/delete/<%= userDoc._id %>" method="POST" style="display:inline-block;" onsubmit="return confirm('Delete this user? This is permanent.')">
          <button class="btn btn-sm btn-danger">Delete</button>
        </form>
        <form action="/admin/users/toggle-status/<%= userDoc._id %>" method="POST" style="display:inline-block; margin-left:8px;">
          <button class="btn btn-sm btn-warning"><%= userDoc.status === 'inactive' ? 'Activate' : 'Deactivate' %></button>
        </form>
        <a href="/admin/users" class="btn btn-sm btn-outline-primary" style="margin-left:8px;">Back to users</a>
      </div>
    </div>
  </div>
</div>
<%- include('../../partials/footer') %>